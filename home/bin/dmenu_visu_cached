#!/bin/bash

VISUDIR=/home/mgr/ExternalMounts/autinitysrv/mgr/visuv2

find_files() {
    find "$VISUDIR" -name '*.pm' -o -name '*.pl' -o -name '*.css' -o -name '*.js' > "$VISUDIR/.dmenu_visu_cache"
}

watch_visu() {
    while inotifywait -r "$VISUDIR"; do
        find_files
    done
}

find_files

[ "$1" != 'nowatch' ] && watch_visu
